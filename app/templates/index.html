<link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">

<div class="container">
  <h1 class="heading">People
    {% if secret_active %}
      <span class="secret-indicator" title="Debug mode active">üîß</span>
    {% endif %}
  </h1>
  <div class="auth">
    {% if username %}
      <span class="muteds">Logged in as {{ username }}</span>
      <a href="{{ url_for('logout') }}" class="button link">Logout</a>
    {% else %}
      <a href="{{ url_for('login') }}" class="button">Login</a>
    {% endif %}
  </div>
  {% if error_message %}
    <div class="alert{% if 'API Service Error' in error_message or 'Redis not available' in error_message %} alert-error{% endif %}">
      {% if 'API Service Error' in error_message %}
        <strong>‚ö†Ô∏è API Service Issue:</strong><br>
      {% elif 'Redis not available' in error_message %}
        <strong>üî¥ Redis Connection Issue:</strong><br>
      {% endif %}
      {{ error_message }}
    </div>
  {% endif %}
  {% if replica %}
    <div class="alert">
        <strong>Replica Name: {{ replica }}</strong><br>
    </div>
  {% endif %}
  {% if username %}
    <form method="post" action="/add" class="form">
      <input name="name" placeholder="Name" required class="input">
      <button type="submit" class="button">Add</button>
    </form>
  {% else %}
    <p class="muteds">Log in to add people and view data.</p>
  {% endif %}
  <div class="table-wrap">
    <table class="table">
      <thead>
        <tr>
          <th class="th id">ID</th>
          <th class="th">Name</th>
          <th class="th">Username</th>
          <th class="th">replica_session</th>
        </tr>
      </thead>
      <tbody>
        {% if username and people %}
          {% for person in people %}
            <tr>
              <td class="td id muteds">{{ person['id'] }}</td>
              <td class="td">{{ person['name'] }}</td>
              <td class="td">{{ person['username'] }}</td>
              <td class="td">{{ person['replica_session'] }}</td>
            </tr>
          {% endfor %}
        {% elif username %}
          <tr>
            <td class="td empty" colspan="2">No people to display.</td>
          </tr>
        {% else %}
          <tr>
            <td class="td empty" colspan="2">Please log in to view people.</td>
          </tr>
        {% endif %}
      </tbody>
    </table>
  </div>
</div>

